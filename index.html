// ...existing code...
    <style>
      // ...existing code...
      .menu-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        margin: 20px 0;
      }
      .menu-button {
        padding: 15px 40px;
        font-size: 18px;
        border-radius: 12px;
      }
      .rooms-list {
        background: #f8fafc;
        border-radius: 12px;
        padding: 16px;
        margin: 20px 0;
        max-height: 300px;
        overflow-y: auto;
      }
      .room-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        background: white;
        margin-bottom: 8px;
        border-radius: 8px;
        border: 1px solid #e5e7eb;
      }
      .room-item:hover {
        border-color: #667eea;
      }
      .host-setup {
        display: flex;
        gap: 12px;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
      }
    </style>

    <div class="container">
      <h2>Stick Fight</h2>
      
      <!-- Hoofdmenu -->
      <div id="mainMenu">
        <div class="menu-buttons">
          <button class="menu-button" onclick="showHostSetup()">Host Game</button>
          <button class="menu-button" onclick="showJoinList()">Join Game</button>
        </div>
      </div>

      <!-- Host setup scherm -->
      <div id="hostSetup" style="display:none">
        <div class="host-setup">
          <input id="playerName" placeholder="Jouw naam" value="Speler" />
          <button id="btnStartHost">Start Game</button>
          <button onclick="showMainMenu()">Terug</button>
        </div>
      </div>

      <!-- Join/Rooms lijst -->
      <div id="joinSetup" style="display:none">
        <div class="host-setup">
          <input id="joinPlayerName" placeholder="Jouw naam" value="Speler" />
          <button onclick="refreshRooms()">Vernieuw Lijst</button>
          <button onclick="showMainMenu()">Terug</button>
        </div>
        <div class="rooms-list" id="roomsList">
          <div class="room-item">Klik 'Vernieuw Lijst' om games te zien</div>
        </div>
      </div>

      <!-- Game area (canvas etc) -->
      <div id="gameArea" style="display:none">
        // ...rest of game UI...
      </div>
    </div>

    <script>
      // ...existing Firebase setup...

      (function() {
        // ...existing code...

        // UI Management
        window.showMainMenu = function() {
          document.getElementById('mainMenu').style.display = 'block';
          document.getElementById('hostSetup').style.display = 'none';
          document.getElementById('joinSetup').style.display = 'none';
          document.getElementById('gameArea').style.display = 'none';
        }

        window.showHostSetup = function() {
          document.getElementById('mainMenu').style.display = 'none';
          document.getElementById('hostSetup').style.display = 'block';
        }

        window.showJoinList = function() {
          document.getElementById('mainMenu').style.display = 'none';
          document.getElementById('joinSetup').style.display = 'block';
          refreshRooms();
        }

        // Host game start
        document.getElementById('btnStartHost').addEventListener('click', () => {
          const name = document.getElementById('playerName').value || 'Speler';
          const room = 'room-' + Math.random().toString(36).slice(2, 7);
          
          if (!window.__db) {
            console.log('Firebase niet geinitialiseerd');
            return;
          }

          game = new Game(name);
          game.startOnline(window.__db, room, true);
          document.getElementById('hostSetup').style.display = 'none';
          document.getElementById('gameArea').style.display = 'block';
        });

        // Verbeterde rooms lijst
        window.refreshRooms = async function() {
          if (!window.__db) {
            console.log('Firebase niet geinitialiseerd');
            return;
          }

          const roomsList = document.getElementById('roomsList');
          roomsList.innerHTML = '<div class="room-item">Laden...</div>';
          
          try {
            const snap = await window.__db
              .collection('rooms')
              .where('state','==','matchmaking')
              .orderBy('updatedAt','desc')
              .limit(10)
              .get();

            if (snap.empty) {
              roomsList.innerHTML = '<div class="room-item">Geen actieve games gevonden</div>';
              return;
            }

            roomsList.innerHTML = '';
            snap.forEach(doc => {
              const data = doc.data();
              const room = doc.id.replace(/^stickfight_/, '');
              const el = document.createElement('div');
              el.className = 'room-item';
              el.innerHTML = `
                <span>${data.hostName || '?'} wacht op opponent</span>
                <button onclick="joinRoom('${room}')">Join Game</button>
              `;
              roomsList.appendChild(el);
            });
          } catch (e) {
            roomsList.innerHTML = `<div class="room-item">Error: ${e.message || 'Onbekende fout'}</div>`;
          }
        }

        // Join functie
        window.joinRoom = function(room) {
          const name = document.getElementById('joinPlayerName').value || 'Speler';
          game = new Game(name);
          game.startOnline(window.__db, room, false);
          document.getElementById('joinSetup').style.display = 'none';
          document.getElementById('gameArea').style.display = 'block';
        }

        // Start in hoofdmenu
        showMainMenu();
        
        // ...rest of existing code...
      })();
    </script>